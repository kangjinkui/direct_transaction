<div class="page-container py-8 space-y-6">
  <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
    <div>
      <h1 class="text-3xl font-bold"><%= @farmer.business_name %> 대시보드</h1>
      <p class="text-sm text-base-content/70">농가 주문 및 상품 관리</p>
    </div>
    <div class="flex flex-wrap gap-2">
      <%= link_to "상품 관리", farmers_products_path, class: "btn btn-primary btn-sm" %>
      <%= link_to "프로필 설정", farmers_profile_path, class: "btn btn-ghost btn-sm" %>
    </div>
  </div>

  <!-- 통계 카드 -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div class="card bg-base-100 shadow-lg">
      <div class="card-body">
        <p class="text-sm text-base-content/70">전체 상품</p>
        <p class="text-3xl font-bold"><%= @stats[:total_products] %>개</p>
        <p class="text-xs text-base-content/60">판매중: <%= @stats[:available_products] %>개</p>
      </div>
    </div>
    <div class="card bg-base-100 shadow-lg">
      <div class="card-body">
        <p class="text-sm text-base-content/70">오늘 주문</p>
        <p class="text-3xl font-bold"><%= @stats[:orders_today] %>건</p>
      </div>
    </div>
    <div class="card bg-base-100 shadow-lg">
      <div class="card-body">
        <p class="text-sm text-base-content/70">승인 대기</p>
        <p class="text-3xl font-bold text-warning"><%= @stats[:pending_orders] %>건</p>
      </div>
    </div>
    <div class="card bg-base-100 shadow-lg">
      <div class="card-body">
        <p class="text-sm text-base-content/70">총 매출 (완료)</p>
        <p class="text-2xl font-bold">
          <%= number_to_currency(@stats[:total_revenue] / 100.0, unit: "", precision: 0) %>원
        </p>
      </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- 승인 대기 주문 -->
    <section class="card bg-base-100 shadow-lg">
      <div class="card-body">
        <div class="flex items-center justify-between">
          <div>
            <h2 class="text-lg font-semibold">승인 대기 주문</h2>
            <p class="text-sm text-base-content/70">빠른 처리가 필요한 주문입니다</p>
          </div>
          <div class="badge badge-warning"><%= @stats[:pending_orders] %>건</div>
        </div>

        <% if @pending_orders.empty? %>
          <div class="py-6 text-sm text-base-content/70">승인 대기 중인 주문이 없습니다.</div>
        <% else %>
          <div class="overflow-x-auto">
            <table class="table">
              <thead>
                <tr>
                  <th>주문번호</th>
                  <th>고객</th>
                  <th>금액</th>
                  <th>상태</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <% @pending_orders.each do |order| %>
                  <tr>
                    <td class="font-mono text-xs"><%= order.order_number %></td>
                    <td><%= order.user.name %></td>
                    <td><%= number_to_currency(order.total_amount / 100.0, unit: "", precision: 0) %>원</td>
                    <td><%= render BadgeComponent.new(status: order.status) %></td>
                    <td class="text-right">
                      <%= link_to "상세", farmers_order_path(order), class: "btn btn-ghost btn-xs" %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% end %>
      </div>
    </section>

    <!-- 최근 주문 -->
    <section class="card bg-base-100 shadow-lg">
      <div class="card-body">
        <div class="flex items-center justify-between">
          <div>
            <h2 class="text-lg font-semibold">최근 주문</h2>
            <p class="text-sm text-base-content/70">최근 10개 주문 내역</p>
          </div>
          <%= link_to "전체 보기", farmers_orders_path, class: "link link-primary text-sm" %>
        </div>

        <% if @recent_orders.empty? %>
          <div class="py-6 text-sm text-base-content/70">주문 내역이 없습니다.</div>
        <% else %>
          <div class="overflow-x-auto">
            <table class="table table-sm">
              <thead>
                <tr>
                  <th>주문번호</th>
                  <th>상태</th>
                  <th>금액</th>
                  <th>일시</th>
                </tr>
              </thead>
              <tbody>
                <% @recent_orders.each do |order| %>
                  <tr>
                    <td class="font-mono text-xs">
                      <%= link_to order.order_number, farmers_order_path(order), class: "link link-primary" %>
                    </td>
                    <td><%= render BadgeComponent.new(status: order.status) %></td>
                    <td><%= number_to_currency(order.total_amount / 100.0, unit: "", precision: 0) %>원</td>
                    <td class="text-xs"><%= l(order.created_at, format: :short) %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% end %>
      </div>
    </section>
  </div>

  <!-- 농가 정보 -->
  <div class="card bg-base-100 shadow-lg">
    <div class="card-body">
      <h2 class="card-title">농가 정보</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <p class="text-sm text-base-content/70">대표자</p>
          <p class="font-medium"><%= @farmer.owner_name %></p>
        </div>
        <div>
          <p class="text-sm text-base-content/70">연락처</p>
          <p class="font-medium"><%= @farmer.phone %></p>
        </div>
        <div>
          <p class="text-sm text-base-content/70">승인 방식</p>
          <p>
            <span class="badge badge-sm <%= @farmer.approval_mode_manual? ? 'badge-primary' : 'badge-success' %>">
              <%= @farmer.approval_mode_manual? ? '수동 승인' : '자동 승인' %>
            </span>
          </p>
        </div>
        <div>
          <p class="text-sm text-base-content/70">알림 방식</p>
          <p>
            <span class="badge badge-sm <%= @farmer.notification_method == 'kakao' ? 'badge-warning' : 'badge-info' %>">
              <%= @farmer.notification_method %>
            </span>
          </p>
        </div>
      </div>
      <div class="mt-4">
        <%= link_to "프로필 수정", farmers_profile_path, class: "btn btn-primary btn-sm" %>
      </div>
    </div>
  </div>
</div>
