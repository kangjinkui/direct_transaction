<div class="container mx-auto px-4 py-8">
  <div class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold">장바구니</h1>
    <% if @cart_items.any? %>
      <%= button_to "전체 비우기", destroy_all_cart_items_path,
                    method: :delete,
                    data: { confirm: "장바구니를 모두 비우시겠습니까?" },
                    class: "btn btn-ghost btn-sm" %>
    <% end %>
  </div>

  <% if @cart_items.empty? %>
    <div class="text-center py-16">
      <div class="text-6xl mb-4">🛒</div>
      <p class="text-xl text-base-content/70 mb-6">장바구니가 비어있습니다</p>
      <%= link_to "상품 둘러보기", products_path, class: "btn btn-primary" %>
    </div>
  <% else %>
    <div class="grid lg:grid-cols-3 gap-6">
      <div class="lg:col-span-2 space-y-6">
        <% @cart_items_by_farmer.each do |farmer, items| %>
          <%= render Cart::FarmerSectionComponent.new(farmer: farmer, cart_items: items) %>
        <% end %>
      </div>

      <div class="lg:col-span-1">
        <div class="card bg-base-100 shadow-lg sticky top-4">
          <div class="card-body">
            <h3 class="card-title">주문 요약</h3>

            <div class="space-y-3 py-4">
              <div class="flex justify-between">
                <span>총 상품 수</span>
                <span class="font-medium"><%= @cart_items.count %>개</span>
              </div>

              <div class="flex justify-between">
                <span>총 수량</span>
                <span class="font-medium"><%= @cart_items.sum(&:quantity) %>개</span>
              </div>

              <div class="divider"></div>

              <div class="flex justify-between items-center text-lg">
                <span class="font-bold">총 결제 금액</span>
                <span class="text-2xl font-bold text-primary">
                  <%= number_to_currency(@cart_items.sum(&:subtotal)) %>원
                </span>
              </div>
            </div>

            <div class="card-actions">
              <%= link_to "주문하기", new_order_path, class: "btn btn-primary btn-block btn-lg" %>
            </div>

            <p class="text-sm text-base-content/60 text-center mt-2">
              농가별로 별도 주문이 생성되며, 각 농가의 계좌로 입금하셔야 합니다.
            </p>
            <p class="text-sm text-base-content/60 text-center mt-2">
              * 농가별로 배송비가 별도 부과될 수 있습니다
            </p>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>
